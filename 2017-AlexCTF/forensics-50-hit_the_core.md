# Fore1: Hit the core

```
root@kali64:~$ file fore1.core
fore1.core: ELF 64-bit LSB core file x86-64, version 1 (SYSV), SVR4-style, from './code', real uid: 1000, effective uid: 1000, real gid: 1000, effective gid: 1000, execfn: './code', platform: 'x86_64'
```

```
root@kali64:~$ readelf -n fore1.core

Displaying notes found at file offset 0x00000350 with length 0x00000a6c:
  Owner                 Data size	Description
  CORE                 0x00000088	NT_PRPSINFO (prpsinfo structure)
  CORE                 0x00000150	NT_PRSTATUS (prstatus structure)
  CORE                 0x00000200	NT_FPREGSET (floating point registers)
  LINUX                0x00000340	NT_X86_XSTATE (x86 XSAVE extended state)
   description data: 7f 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ffffff80 1f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ffffffe8 ffffffb2 16 65 ffffff88 7f 00 00 ffffffe8 ffffffb2 16 65 ffffff88 7f 00 00 ffffffd8 ffffffb2 16 65 ffffff88 7f 00 00 ffffffd8 ffffffb2 16 65 ffffff88 7f 00 00 7d 00 00 00 7e 00 00 00 7f 00 00 00 ffffff80 00 00 00 ffffffd0 ffffffaa 16 65 ffffff88 7f 00 00 ffffffd0 ffffffaa 16 65 ffffff88 7f 00 00 0d 00 00 00 00 00 00 00 0d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff 04 00 00 00 04 00 00 00 04 00 00 00 04 00 00 00 ffffffb8 ffffffb2 16 65 ffffff88 7f 00 00 ffffffb8 ffffffb2 16 65 ffffff88 7f 00 00 ffffffff 2f 2f 2f 2f ffffffff 2f ffffffff 2f 2f 2f ffffffff 2f 2f 2f 2f ffffffff ffffffff 2f 2f 2f ffffffff 2f ffffffff 2f 2f 2f ffffffff 2f 2f 2f 2f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  CORE                 0x00000080	NT_SIGINFO (siginfo_t data)
  CORE                 0x00000130	NT_AUXV (auxiliary vector)
  CORE                 0x00000115	NT_FILE (mapped files)
    Page size: 1
                 Start                 End         Page Offset
    0x0000000000401000  0x0000000000402000  0x0000000000000000
        /home/oddcoder/projects/ctf/forensics/FORE1/code
    0x00007f8865166000  0x00007f886516a000  0x00000000001bc000
        /usr/lib64/libc-2.24.so
    0x00007f886516a000  0x00007f886516c000  0x00000000001c0000
        /usr/lib64/libc-2.24.so
    0x00007f8865395000  0x00007f8865396000  0x0000000000025000
        /usr/lib64/ld-2.24.so
    0x00007f8865396000  0x00007f8865397000  0x0000000000026000
        /usr/lib64/ld-2.24.so
```

```
root@kali64:~$ gdb -q -c fore1.core
[New LWP 21774]
Core was generated by `./code'.
#0  0x00007f8864ea1bd0 in ?? ()

gdb-peda$ info proc mappings
Mapped address spaces:

          Start Addr           End Addr       Size     Offset objfile
            0x401000           0x402000     0x1000        0x0 /home/oddcoder/projects/ctf/forensics/FORE1/code
      0x7f8865166000     0x7f886516a000     0x4000   0x1bc000 /usr/lib64/libc-2.24.so
      0x7f886516a000     0x7f886516c000     0x2000   0x1c0000 /usr/lib64/libc-2.24.so
      0x7f8865395000     0x7f8865396000     0x1000    0x25000 /usr/lib64/ld-2.24.so

gdb-peda$ dump binary memory fore1.mem.dump 0x401000 0x402000
```

We analyse the `fore1.mem.dump` in IDA and find the key printing algorithm:

```c
__int64 __fastcall main(__int64 a1, char **a2, char **a3)
{
  size_t v3; // rbx@3
  char v5; // [sp+0h] [bp-60h]@1
  char *s; // [sp+40h] [bp-20h]@1
  int i; // [sp+4Ch] [bp-14h]@1

  s = "cvqAeqacLtqazEigwiXobxrCrtuiTzahfFreqc{bnjrKwgk83kgd43j85ePgb_e_rwqr7fvbmHjklo3tews_hmkogooyf0vbnk0ii87Drfgh_n kiw"
      "utfb0ghk9ro987k5tfb_hjiouo087ptfcv}";
  _isoc99_scanf("%s", &v5, a3);
  for ( i = 3; ; i += 5 )
  {
    v3 = i;
    if ( v3 >= strlen(s) )
      break;
    putchar(s[i]);
  }
  putchar(10);
  return 0LL;
}
```

Solution:

```python
from sys import stdout

s = "cvqAeqacLtqazEigwiXobxrCrtuiTzahfFreqc{bnjrKwgk83kgd43j85ePgb_e_rwqr7fvbmHjklo3tews_hmkogooyf0vbnk0ii87Drfgh_n kiw"

for i in range(3, len(s), 5): stdout.write(s[i])
```

```
ALEXCTF{K33P_7H3_g00D_w0rk_up}
```



